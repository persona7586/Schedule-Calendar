{% extends "base.html" %}
{% block title %}메모 상세 – {{ memo.title }}{% endblock %}

{% block content %}
  <div class="mt-4">

    {# ─── 뷰 모드 (읽기 전용) ───────────────────── #}
    <div id="view-mode">
      <h3>{{ memo.title }}</h3>
      <p class="text-secondary small">
        작성일: {{ memo.created_at|date:"Y-m-d H:i" }}
      </p>
      <div class="border p-3 mb-3">
        {{ memo.content|linebreaks }}
      </div>

      <button id="edit-button" class="btn btn-primary">수정</button>
      <a href="{% url 'home' %}" class="btn btn-secondary">← 메인으로</a>

      <form method="post" action="{% url 'memo_delete' memo.id %}"
            onsubmit="return confirm('정말 삭제하시겠습니까?');"
            style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger">삭제</button>
      </form>
    </div>

    {# ─── 편집 모드 (폼) ───────────────────────── #}
    <form id="edit-form"
          method="post"
          action="{% url 'memo_edit' memo.id %}"
          style="display: none;">
      {% csrf_token %}
      <div class="mb-2">
        <input type="text" name="title"
               class="form-control"
               value="{{ memo.title }}"
               required>
      </div>
      <div class="mb-2">
        <textarea name="content"
                  class="form-control"
                  rows="5"
                  required>{{ memo.content }}</textarea>
      </div>
      <button type="submit" class="btn btn-success">수정 완료</button>
      <button type="button" id="cancel-button"
              class="btn btn-secondary">취소</button>
    </form>

  </div>

  <script>
    // 수정 버튼 → 편집 모드 보이기
    document.getElementById('edit-button').addEventListener('click', function() {
      document.getElementById('view-mode').style.display = 'none';
      document.getElementById('edit-form').style.display = 'block';
    });
    // 취소 버튼 → 뷰 모드로 돌아가기
    document.getElementById('cancel-button').addEventListener('click', function() {
      document.getElementById('edit-form').style.display = 'none';
      document.getElementById('view-mode').style.display = 'block';
    });
  </script>
{% endblock %}
